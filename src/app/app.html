<!-- Navbar outside theme wrapper - always consistent -->
<ng-container *ngIf="this.authService.isAuthenticated()">
  <app-navbar></app-navbar>
</ng-container>



<!-- Floating Dark Mode Toggle (global) -->
<button class="theme-toggle-floating" (click)="toggleTheme()" type="button">
  <span class="theme-icon">{{ isDarkMode() ? '☀️' : '🌙' }}</span>
  <span class="theme-text">{{ isDarkMode() ? 'Light Mode' : 'Dark Mode' }}</span>
</button>

<!-- Main content with theme wrapper -->
<div [attr.data-theme]="isDarkMode() ? 'dark' : null">
  <!-- Cart Modal - positioned above router content -->
  <div class="cart-modal-overlay" *ngIf="this.authService.isAuthenticated() && isCartOpen()" (click)="closeCart()">
    <div class="cart-modal-content" (click)="$event.stopPropagation()">
      <app-cart></app-cart>
    </div>
  </div>

  <!-- Main Content Area -->
  <router-outlet></router-outlet>

  <ng-container *ngIf="this.authService.isAuthenticated()">
    <app-footer></app-footer>
  </ng-container>
</div>